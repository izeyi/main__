<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>魔方云</title>
<link rel="stylesheet" href="css/base.css">
<script type="text/javascript" src="../js/config/index.js"></script>
<!-- <script src="http://static.namenb.com/web/js/?tcbox" type="text/javascript"></script> -->
<script src="../js/config.js" type="text/javascript"></script>
<script src="../js/lib/cityselect.js" type="text/javascript"></script>
<style type="text/css">
    /* 城市选择器样式 */
    .citySelector{font:12px/1.5 tahoma,arial,\5b8b\4f53;background:#fff;text-align:left;}
    .cityslide{width:250px;list-style:none;margin:0;padding:0;border:1px solid #B3CDC0;box-shadow:2px 2px 3px rgba(0,0,0,0.3);overflow:auto;max-height:300px;}
    .cityslide li{list-style:none;overflow:hidden;height:30px;padding:0px 10px;line-height:30px;}
    .cityslide li.on{background:#ec302c;color:#fff;cursor:pointer;}
    .cityslide li:hover{background:#ec302c;color:#fff;cursor:pointer;}
    .cityslide li b{font-weight:normal;}
    .cityslide li.empty{background:#fff2e8;color:#666;}
    .cityslide li.empty em{color:red;font-style:normal;}
    .cityname{float:left;}
    .cityspell{float:right;}
    .cityBox{width:380px;border:1px solid #B3CDC0;overflow:hidden;box-shadow:2px 2px 3px rgba(0,0,0,0.3);}
    .cityBox ul{margin:0;padding:0;overflow:hidden;}
    .cityBox ul li:first-child{margin-left:5px;}
    .cityBox ul li{float:left;list-style:none;padding:5px;border-bottom:1px solid #DDD;cursor:pointer;display:inline;color:#ec302c;}
    .cityBox ul li.on{border-bottom-color:#ec302c;position:relative;}
    .hide{display:none;}
    p.tip{color:#999;line-height:20px;padding:5px;margin:0;text-indent:3px;}
    .hotCity{border-top:1px solid #DDD;margin-top:-1px;clear:left;overflow:hidden;padding-bottom:10px;padding-top:10px;_margin-bottom:8px;}
    .cityTab{overflow:hidden;}
    .cityTab dl{margin:0;padding:0 0 0 10px;overflow:hidden;}
    .cityTab dl dt{float:left;padding-left:3px;color:#ec302c;margin-top:1px;text-indent:5px;font-family:"Lucida console","consolas","courier new";line-height:25px;font-size:14px;width:20px;}
    .cityTab dl dd{margin-left:2px;float:left;width:335px;}
    .cityTab dl dd a{padding-left:5px;min-width:66px;line-height:25px;display:inline-block;color:#333;text-decoration:none;}
    .cityTab dl dd a:hover{color:#ec302c;}
    .cityinput{ font-size: 12px; padding-left: 2px; border: 1px solid #D8D8D8; }
</style>
</head>
<body>
    <div class="box information">
        <form id="T_add_form">
            <p class="p"><img src="images/bb.png" alt="">完善基本资料</p>
            <div class='form'>
                <label for="comname">
                    <span>公司名称</span>
                    <input type="text" name="comname" id="CompanyName" placeholder="请输入公司名称">
                </label>
                <label for="minname">
                    <span>公司简称</span>
                    <input type="text" name="minname" placeholder="请输入公司简称2-4字以内">
                </label>
                <label for="city">
                    <span>所在城市</span>
                    <input type="text" name="city" id="citySelect" placeholder="请选择您所在的城市">
                </label>
                <label for="address">
                    <span>详细地址</span>
                    <input type="text" name="address" placeholder="请输入详细地址">
                </label>
                <label for="nickname">
                    <span>您的姓名</span>
                    <input type="text" name="nickname" placeholder="请输入姓名">
                </label>
                <label for="position">
                    <span>您的职务</span>
                    <input type="text" name="position" placeholder="请输入职务">
                </label>
                <label for="comphone">
                    <span>公司电话</span>
                    <input type="text" name="comphone" placeholder="请输入公司号码">
                </label>
            </div>
            <div class='form'>
                <div class="zt_form_item">
                    <label for="comindustry" class="zt_form_label">所属行业</label>
                    <div class="zt_input_block select-menu-div">
                        <input type="text" name="comindustry" class="zt_input select-menu-input" placeholder="请选择您的企业性质" readonly/>
                        <input type="hidden" name="comindustry" class="zt_input select-menu-input-v"/>
                    </div>
                    <ul class="select-menu-ul" >
                        <li data-value="">请选择您所属的行业</li>
                        <li data-value="策划营销">策划营销</li>
                        <li data-value="视频制作">视频制作</li>
                        <li data-value="新媒体">新媒体</li>
                        <li data-value="设计服务">设计服务</li>
                        <li data-value="网络技术">网络技术</li>
                        <li data-value="活动会展">活动会展</li>
                        <li data-value="活动会展">咨询</li>
                        <li data-value="其他">其他</li>
                    </ul>
                </div>
               <!--  <label for="comindustry">
                    <span>所属行业</span>
                    <select name="comindustry" id="comindustry">
                        <option value="请选择您所属的行业">请选择您所属的行业</option>
                        <option value="游戏 | 动漫">游戏 | 动漫</option>
                        <option value="传媒 | 广告 | 影视">传媒 | 广告 | 影视</option>
                        <option value="汽车 | 快消品 | 时尚">汽车 | 快消品 | 时尚</option>
                        <option value="金融 | 保险 | 证券 | 银行人">金融 | 保险 | 证券 | 银行人</option>
                        <option value="生物 | 医药 | 能源 | 航空">生物 | 医药 | 能源 | 航空</option>
                        <option value="科技 | 通信 | TMT">科技 | 通信 | TMT</option>
                        <option value="互联网+ | 人工智能 | O2O">互联网+ | 人工智能 | O2O</option>
                        <option value="房地产 | 家居">房地产 | 家居</option>
                        <option value="教育 | 培训 | 咨询">教育 | 培训 | 咨询</option>
                    </select>
                </label> -->
                <div class="zt_form_item">
                    <label for="comscale" class="zt_form_label">公司规模</label>
                    <div class="zt_input_block select-menu-div">
                        <input type="text" name="comscale" class="zt_input select-menu-input" placeholder="请选择您的企业性质" readonly/>
                        <input type="hidden" name="comscale" class="zt_input select-menu-input-v"/>
                    </div>
                    <ul class="select-menu-ul" >
                        <li data-value="">请选择您企业的规模</li>
                        <li data-value="20人以下">20人以下</li>
                        <li data-value="20-50人">20-50人</li>
                        <li data-value="50人-100人">50人-100人</li>
                        <li data-value="100-300人">100-300人</li>
                        <li data-value="300人-500人">300人-500人</li>
                        <li data-value="500人-1000人">500人-1000人</li>
                        <li data-value="其他">其他</li>
                    </ul>
                </div>
                <div class="zt_form_item">
                    <label for="comtype" class="zt_form_label">公司类型</label>
                    <div class="zt_input_block select-menu-div">
                        <input type="text" name="comtype" class="zt_input select-menu-input" placeholder="请选择您的企业性质" readonly/>
                        <input type="hidden" name="comtype" class="zt_input select-menu-input-v"/>
                    </div>
                    <ul class="select-menu-ul" >
                        <li data-value="央企">央企</li>
                        <li data-value="政府">政府</li>
                        <li data-value="国企">国企</li>
                        <li data-value="外企">外企</li>
                        <li data-value="合资">合资</li>
                        <li data-value="民营">民营</li>
                        <li data-value="其他">其他</li>
                    </ul>
                </div>
                <!-- <div class="zt_form_item">
                    <label for="" class="zt_form_label">相册类型</label>
                    <div class="zt_input_block select-menu-div">
                        <input type="text" name="" class="zt_input select-menu-input" placeholder="请选择您的企业性质" readonly/>
                        <input type="hidden" name="com_type" class="zt_input select-menu-input-v"/>
                    </div>
                    <ul class="select-menu-ul" >
                        <li data-value="央企">央企</li>
                        <li data-value="政府">政府</li>
                        <li data-value="国企">国企</li>
                        <li data-value="外企">外企</li>
                        <li data-value="合资">合资</li>
                        <li data-value="民营">民营</li>
                        <li data-value="其他">其他</li>
                    </ul>
                </div> -->
                <!-- <div class="zt_form_item">
                    <label for="" class="zt_form_label">上传头像</label>
                    <div class="upload-item">
                        <div class="upload-photo">
                            <i class="icon-add"></i>
                            <p>支持20MB的JPG格式照片<br>不建议加水印签名</p>
                        </div>
                        <div class="upload-img">
                            <img src="">
                        </div>
                        <input type="file" name="face" class="file-input" id="face" multiple="" accept="image/jpeg,image/jpg,image/png">
                        <input type="hidden" name="face" class="face">
                    </div>
                </div> -->
                <div class="zt_form_item">
                    <label for="" class="zt_form_label">公司图标</label>
                    <div class="upload-item">
                        <div class="upload-photo">
                            <i class="icon-add"></i>
                            <p>支持20MB的JPG格式照片<br>不建议加水印签名</p>
                        </div>
                        <div class="upload-img">
                            <img src="">
                        </div>
                        <input type="file" name="logo" class="file-input" id="logo" multiple="" accept="image/jpeg,image/jpg,image/png">
                        <input type="hidden" name="logo" class="logo">
                    </div>
                </div>
                <div class="zt_form_item">
                    <label for="" class="zt_form_label">营业执照</label>
                    <div class="upload-item">
                        <div class="upload-photo">
                            <i class="icon-add"></i>
                            <p>支持20MB的JPG格式照片<br>不建议加水印签名</p>
                        </div>
                        <div class="upload-img">
                            <img src="">
                        </div>
                        <input type="file" name="license" class="file-input" id="license" multiple="" accept="image/jpeg,image/jpg,image/png">
                        <input type="hidden" name="license" class="license">
                    </div>
                </div>
            </div>
        </form>

        <div><span class='colse colse2 t_colse'>进入魔方</span></div>
    </div>
    <script>
        var CompanyArr = ['有限公司', '有限责任公司', '合伙', '有限合伙', '事务所', '委员会', '研究所', '院', '学院', '协会', '组织', '大学', '高中', '小学', '幼儿园'];
        var _GlobalsApi_ = "";
        $(function () {
            selectMenu(0);
            selectMenu(1);
            selectMenu(2);
            new Vcity.CitySelector({input:'citySelect'});//城市选择
            //下拉列表
            function selectMenu(index) {
                $(".select-menu-input").eq(index).val($(".select-this").eq(index).html()); //在输入框中自动填充第一个选项的值
                $(".select-menu-input-v[type=hidden]").eq(index).val($(".select-this").eq(index).data('value'));
                $(".select-menu-div").eq(index).on("click", function(e) {
                    e.stopPropagation();
                    if($(".select-menu-ul").eq(index).css("display") === "block") {
                        $(".select-menu-ul").eq(index).hide();
                        $(".select-menu-div").eq(index).find("i").removeClass("select-menu-i");
                        $(".select-menu-ul").eq(index).animate({marginTop: "50px",opacity: "0"}, "fast");
                    } else {
                        $(".select-menu-ul").eq(index).show();
                        $(".select-menu-div").eq(index).find("i").addClass("select-menu-i");
                        $(".select-menu-ul").eq(index).animate({marginTop: "5px",opacity: "1"}, "fast");
                    }
                    for(var i = 0; i < $(".select-menu-ul").length; i++) {
                        if(i !== index && $(".select-menu-ul").eq(i).css("display") === "block") {
                            $(".select-menu-ul").eq(i).hide();
                            $(".select-menu-div").eq(i).find("i").removeClass("select-menu-i");
                            $(".select-menu-ul").eq(i).animate({marginTop: "50px",opacity: "0"}, "fast");
                        }
                    }
                });
                $(".select-menu-ul").eq(index).on("click", "li", function() { //给下拉选项绑定点击事件
                    $(".select-menu-input").eq(index).val($(this).html()); //把被点击的选项的值填入输入框中
                    $(".select-menu-input-v[type=hidden]").eq(index).val($(this).data('value'));
                    $(".select-menu-div").eq(index).click();
                    $(this).siblings(".select-this").removeClass("select-this");
                    $(this).addClass("select-this");
                });
                $("body").on("click", function(event) {
                    event.stopPropagation();
                    if($(".select-menu-ul").eq(index).css("display") === "block") {
                        $(".select-menu-ul").eq(index).hide();
                        $(".select-menu-div").eq(index).find("i").removeClass("select-menu-i");
                        $(".select-menu-ul").eq(index).animate({marginTop: "50px",opacity: "0"}, "fast");
                    }

                });
            }
            // 上传图片
            var _user = store.get('userinfo');
            var picdata = {'token' : _user['token']};
            $('.file-input').bind('change',function (e) {
                e.preventDefault();
                var formData = new FormData();
                var _name = $(this).attr('name');
                // formData.append("token",picdata.token);
                formData.append("upfile",document.getElementById(_name).files[0]);

                $.ajax({
                    //url: _GlobalsApi_+'http://api.greatorange.cn/box/upfiles/pic/',http://api.greatorange.cn/box/yunFile/file
                    url: globalApi_+'/box/yunFile/file',//上传至七牛云
                    type: 'POST',
                    data: formData,
                    dataType: "json",
                    async: false,
                    cache: false,
                    contentType: false,
                    processData: false,
                    success: function (returndata) {
                        console.log(returndata)
                        if(returndata.success != false){
                            $('#'+_name).parent('.upload-item').addClass('success');
                            $('#'+_name).siblings('.upload-img').children('img').attr("src",returndata['url']);
                            $('.'+_name).val(returndata['url']);
                        }else{
                            msg(returndata.info);
                        }
                    }
                });
            })
            //进入魔方
            $('.colse2').on('click',function () {
                var index_ = parent.layer.getFrameIndex(window.name);
                var _fromdata = serialize(document.forms["T_add_form"]);
                console.log(_fromdata)
                // alert(_fromdata)
                _fromdata["token"] = picdata.token;
                var checkVal = checkvalue(_fromdata,{
                    'comname': '公司名称','minname':'公司简称','city': '所在城市','address': '详细地址','nickname': '联系人',
                    'comphone': '公司电话','license': '营业执照','comindustry': '所属行业','comscale': '企业规模','comtype': '公司类型'
                });
                if(checkVal['success']){//http://api.greatorange.cn/box/userlogin/newcom/
                    httpx.post(globalApi_+"/mfy/api/create_company",_fromdata,function (data) {
                        var _Data = JSON.parse(data)
                        _Data['token'] = store.get('userinfo')['token']
                        console.log(_Data)
                        if(_Data['success']){
                            store.set('com_info',_Data);
                            parent.layer.close(index_);//关闭当前页
                        }
                        msg(JSON.parse(data).info);
                    })
                }else {
                    msg(checkVal.info);
                }
            })
            //公司名验证
            // $('#CompanyName').on('blur', function () {
            //     if (!$(this).val().replace(/\s/g, '').length)
            //         var keys = true;
            //         for (var t = 0; t < CompanyArr.length; t++) {
            //             if ($(this).val().replace(/\s/g, '').indexOf(CompanyArr[t]) === -1) {
            //                 $(this).addClass('error');
            //                 keys = false;
            //                 layer.msg("请输入贵公司完整的名称");
            //             } else {
            //                 $(this).removeClass('error');
            //                 keys = true;
            //                 break;
            //             }
            //         }
            //  }).trigger('focus');
        });
    </script>
</body>
</html>