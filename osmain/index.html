<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>魔方云</title>
  <link href="static/css/style.css" type="text/css" rel="stylesheet" />
  <link href="static/css/iconfont.css" type="text/css" rel="stylesheet" />
  <link href="static/css/loader.css" type="text/css" rel="stylesheet" />
  <script>if (typeof module === 'object'){window.module = module; module = undefined;}</script>
  <script src="../js/config/index.js" type="text/javascript"></script>
  <!-- <script src="http://static.namenb.com/web/js/?tcbox" type="text/javascript"></script> -->
  <script src="../js/config.js" type="text/javascript"></script>
  <!-- 使用引导 -->
  <link href="../js/config/lib/intro/introjs.min.css" type="text/css" rel="stylesheet"/>
  <script src="../js/config/lib/intro/intro.min.js" type="text/javascript"></script>
  <script>
    if (window.module) module = window.module;
    const {ipcRenderer,remote} = require("electron");
    const {Menu,MenuItem} = remote;
    const menu = new Menu()
    menu.append(new MenuItem({ label: '刷新', click() { ipcRenderer.send("loginmain")} }))
    menu.append(new MenuItem({ label: '剪切' ,role:'cut'}));
    menu.append(new MenuItem({ label: '粘贴' ,role:'paste'}));
    //分辨率适配
    var devInnerHeight = 1080.0; //开发时的InnerHeight
    var devDevicePixelRatio = 1.5; //开发时的devicepixelratio
    var devScaleFactor = 1.5; //开发时的ScaleFactor
    var scaleFactor = require('electron').screen.getPrimaryDisplay().scaleFactor;
    var zoomFactor = window.innerHeight / devInnerHeight * window.devicePixelRatio / devDevicePixelRatio * devScaleFactor / scaleFactor;
    require('electron').webFrame.setZoomFactor(zoomFactor);
    /*loading*/
    var _LoadingHtml = '<div id="loader-wrapper"><div id="loader"></div><div class="loader-section section-left"></div><div class="loader-section section-right"></div><div class="load_title">技术天橙，缔造完美<br><span></span></div></div>';
    //呈现loading效果
    document.write(_LoadingHtml)
    setInterval(function () {$('body').addClass('loaded');$('#loader-wrapper .load_title').remove()},1500)
    Vue.filter('is_face', function (str) {if(!str){return 'static/images/head.png'}else{return str}})
    var _user = store.get('userinfo')
    var default_data={"success": true,"userinfo": {"phone":"","openid":"","wxuserinfo":"{}","isadmin":"0","power":null,"nickname":"","position":"","face":"","content":"","status":"0"},"cominfo": {"gid":"","logo":"","comname":"","videotags":"","pictags":"","rtckey": null}}
    // updata();
    console.log(_user)
    var _Arr = ["static/images/des01.jpg","static/images/des02.jpg","static/images/des03.jpg","static/images/des04.jpg"];
    var loginAdminApi = globalApi_+'/box/userlogin/smsloginadmin/';//登录后台
    var sendcodeApi = globalApi_+"/box/sms/sendcode/";//获取验证码
    var _ucenter = globalApi_+"/box/ucenter/info/";
</script>

</head>
<body>


<div id="openbox">
  <!-- 系统桌面 -->
  <div class="webos-background" id="desktop" style="background-image:url(static/images/des02.jpg);"></div>
  <!-- 应用 板块 -->
  <div class="desk_box">
    <header id="Tooblar">
      <div class="tooblarBox">
        <ul class="tooblar">
          <li onclick='ipcRenderer.send("minmain");'><span class="bar_btn" title="最小化"><i class="icon iconfont icon-zuixiaohua"></i></span></li>
          <li onclick='ipcRenderer.send("fullmain");'><span class="bar_btn" title="全屏"><i class="icon iconfont icon-zuidahua"></i></span></li>
          <li onclick='mexit()'><span class="bar_btn" title="关机"><i class="icon iconfont icon-guanji"></i></span></li>
        </ul>
      </div>
    </header>
    <!-- tong end -->
    <div id="desk">
      <ul style="display: flex;width: 336px" data-step="4" data-intro="这里是我们常用的功能模块！">
        <li style="left:30px;top:40px" onclick='openwindow("视频案例","../anlie/index.html","1");'>
          <img src="static/images/icon.png" /><span title="视频案例">视频案例</span><em></em>
        </li>
        <li style="left:30px;top:170px" onclick='openwindow("魔方会议室","../meeting/index.html","2");'>
          <img src="static/images/icon2.png" /><span title="魔方会议室">魔方会议室</span><em></em>
        </li>
         <!-- <li style="left:30px;top:300px" onclick='ipcRenderer.send("cam");'> -->
        <li style="left:30px;top:300px" onclick='onlookers("超级提案","../rtc/cam.html","3");' id="_draft">
          <img src="static/images/icon6.png" /><span title="超级提案">超级提案</span><em></em>
        </li>
        <li style="left:30px;top:430px" onclick='openStaticWin("闪传","../pushvideolist/index.html","1");'>
          <img src="static/images/icon3.png" /><span title="闪传">闪传</span><em></em>
        </li>
        <li style="left: 30px; top: 560px;" onclick='openwindow("产品库","../product/index.html","3");'>
          <img src="static/images/icon00.png" /><span title="产品库">产品库</span><em></em>
        </li>
        <!-- <li style="left:30px;top:560px" onclick='pdfview("AI智慧营销",`file://${__dirname}/../pdffiles/「橙影互联」AI智慧营销.pdf`)'>
          <img src="static/images/icon14.png" /><span title="AI智慧营销">AI智慧营销</span><em></em>
        </li> -->
        <li style="left:30px;top:690px" onclick='openActivity("用户福利","http://yun.greatorange.cn/activity/index.html?id="+_user.token,"3")'>
          <img src="static/images/icon99.png" /><span title="用户福利">用户福利</span><em></em>
        </li>
        <!-- 2 col -->
        <li style="left: 136px; top: 40px;" onclick='openwindow("资料库","../document/index.html","5");'>
          <img src="static/images/icon10.png" /><span title="资料库">资料库</span><em></em>
        </li>
        <li style="left: 136px; top: 170px;" onclick='ipcRenderer.send("website");'>
          <img src="static/images/icon8.png" /><span title="空间站">空间站</span><em></em>
        </li>
        <li style="left: 136px; top: 300px;" onclick='openwindow("关于我们","../about/index.html","6");'>
          <img src="static/images/icon5.png" /><span title="关于天橙">关于我们</span><em></em>
        </li>
        <li style="left: 136px; top: 430px;" onclick='msg("即将开放...")'>
        <!-- <li style="left: 30px; top: 430px;" onclick='msg("即将开放...")'> -->
        <!-- <li style="left: 136px; top: 430px;" onclick='openwindow("任务大厅","http://yun.greatorange.cn/task/task.html?loc=box","7");'> -->
          <img src="static/images/icon4.png" /><span title="任务大厅">任务大厅</span><em></em>
        </li>
        <li style="left: 136px; top: 560px;" onclick='msg("即将开放...")'>
          <img src="static/images/icon23.png" /><span title="园区宝">园区宝</span><em></em>
        </li>
        <!-- 3 col -->
        <li style="left: 242px; top: 40px;" onclick='ipcRenderer.send("opfiles");'>
          <img src="static/images/icon9.png"/><span title="打开文件">打开文件</span><em></em>
        </li>
        <li style="left: 242px; top: 170px;" onclick='ipcRenderer.send("articleSet");'>
          <img src="static/images/icon1.png"/><span title="微文圈">微文圈</span><em></em>
        </li>
     </ul>
    </div>
  </div>
  <!-- 工具栏 -->
  <div class="side-bar">
    <ul style="display: flex;" data-step="3" data-intro="这里是我们魔方云的工具！">
      <li onclick='ipcRenderer.send("wechat");' tooltip="微信登录" flow="down">
        <img src="static/images/icon11.png"/><span title="微信登录">微信登录</span>
      </li>
      <li onclick='onlookers("会议直播","../broadcast/cam.html","4");' tooltip="会议直播" flow="down">
        <img src="static/images/icon21.png"/><span title="会议直播">会议直播</span>
      </li>
      <li onclick='openwindow("会议画板","../drawingboard/index.html","8");' tooltip="会议画板" flow="down">
        <img src="static/images/icon20.png"/><span title="会议画板">会议画板</span>
      </li>
      <li onclick='ipcRenderer.send("airplay");msg("请将手机连接WIFI后使用AirPlay投屏！")' tooltip="魔方投屏" flow="down">
        <img src="static/images/icon22.png"/><span title="魔方投屏">魔方投屏</span>
      </li>
     <!--  <li class="boundary" style="width: 0"></li>
      <li onclick='openwindow("商机•电销","https://web.kdzl.cn/","9")' tooltip="商机•电销" flow="down">
        <img src="static/images/icon13.png"/><span title="商机•电销">商机•电销</span>
      </li> -->
      <li onclick='openweb("商机•橙标","http://ai.namenb.com/toolbox/phoneviewer/?url=http://api.greatorange.cn/bid/index.html?_openid=oSDiUwITps0WeY6ur1m5R0Omp-0w")' tooltip="商机•橙标" flow="down">
        <img src="static/images/icon18.png"/>
        <span title="商机•橙标">商机•橙标</span>
      </li>
     <!--  <li onclick='msg("即将开放...");' tooltip="商机•橙标" flow="down">
        <img src="static/images/icon18.png"/>
        <span title="商机•橙标">商机•橙标</span>
      </li> -->
      <!-- <li onclick='openweb("商机•橙标","http://ai.namenb.com/toolbox/phoneviewer/?url=http://api.greatorange.cn/bid_pro/index.html?_openid=oSDiUwITps0WeY6ur1m5R0Omp-0w")' tooltip="商机•意向" flow="down">
        <img src="static/images/icon17.png"/><span title="商机•意向">商机•意向</span>
      </li> -->
       <li onclick='msg("即将开放...");' tooltip="我要推广" flow="down">
        <img src="static/images/icon7.png"/><span title="我要推广">我要推广</span>
      </li>
    </ul>
  </div>
  <!-- 用户信息 板块 -->
  <div class="webos-card" id="userApp" data-step="1" data-intro="您可以在这里，点击设置修改您的信息！">
    <div class="card-close" onclick="openwindow('信息设置','../ucenter/user_info.html')">设置</div>
    <div class="thumbnail"><img :src="userinfo.face | is_face"/></div>
    <div class="content">
      <div>
        <h3>{{userinfo.nickname}}</h3>
        <span>{{userinfo.position}}</span>
      </div>
      <p>{{cominfo.comname}}</p>
      <!-- <p> <span>宣传片</span> <span>广告片</span> </p> -->
    </div>
  </div>
  <!-- 管理员 板块 -->
  <div class="admin_box">
    <iframe src="" frameborder="0" id="mainframe" width="100%" height="100%"></iframe>
    <div class="to_desktop" data-step="2" data-intro="如果您是管理员，您可以从这里进入后台系统！">
      <div id="t_lt" onclick="to_ucenter()" class="to_admin t_icon card-close" tooltip="进入控制台" flow="left"></div>
      <div id="t_rt" class="Previou t_icon" tooltip="返回系统" flow="right"></div>
    </div>
  </div>
  <!-- IM 板块 -->
  <!-- <div class="IM_box">
    <div class="chat_container" id="chat">
      <div class="chat_inner clearfix">
        <div class="thumbnail panel">
          <div class="header">
            <div class="avatar"><img class="img" :src="userinfo.face | is_face"/></div>
            <div class="info">
              <h3 class="nickname">
                <span class="display_name ng-binding">{{userinfo.nickname}}</span>
                <a class="opt chat_min_win" href="javascript:;" tooltip="收起聊天" flow="down"><i class="wechat_min_win web_wechat_icon"><svg t="1563523720489" class="icon" viewBox="0 0 1086 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4880" xmlns:xlink="http://www.w3.org/1999/xlink" width="31.81640625" height="30"><defs><style type="text/css"></style></defs><path d="M954.23116 954.040083a36.685113 36.685113 0 0 1-53.040085 0l-257.704399-256.966153v173.828374c0 22.71524-15.162423 37.820875-37.877663 37.820875s-37.877663-15.105635-37.877662-37.820875v-279.624605l22.71524-22.658452h280.419638c22.772028 0 37.877663 15.105635 37.877663 37.820875 0 22.658452-15.105635 37.764087-37.877663 37.764086h-174.282679l257.64761 256.966154a36.401172 36.401172 0 0 1 0 52.869721zM150.16845 451.976489c-22.772028 0-37.934451-15.105635-37.934451-37.764086 0-22.71524 15.162423-37.820875 37.934451-37.820875h174.282679L66.803519 119.425375a36.401172 36.401172 0 0 1 0-52.869722 36.628325 36.628325 0 0 1 53.040086 0l257.704398 256.966154V149.693432c0-22.71524 15.162423-37.820875 37.877663-37.820875s37.877663 15.105635 37.877663 37.820875V429.318037l-22.71524 22.658452H150.16845z" p-id="4881" fill="#e6e6e6"></path></svg></i></a>
                <a class="opt chat_max_win" href="javascript:;" tooltip="展开聊天" flow="down"><i class="wechat_max_win web_wechat_icon"><svg t="1563523605119" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4701" width="30" height="30" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"></style></defs><path d="M236.8 192 384 192c19.2 0 32-12.8 32-32C416 140.8 403.2 128 384 128L160 128c0 0 0 0-6.4 0 0 0-6.4 0-6.4 0C140.8 134.4 134.4 140.8 128 147.2c0 0 0 6.4 0 6.4 0 0 0 0 0 6.4L128 384c0 19.2 12.8 32 32 32S192 403.2 192 384L192 236.8l217.6 217.6c12.8 12.8 32 12.8 44.8 0l0 0c12.8-12.8 12.8-32 0-44.8L236.8 192z" p-id="4702" fill="#e6e6e6"></path><path d="M864 608C844.8 608 832 620.8 832 640l0 147.2L614.4 569.6c-12.8-12.8-32-12.8-44.8 0l0 0c-12.8 12.8-12.8 32 0 44.8l217.6 217.6L640 832c-19.2 0-32 12.8-32 32 0 19.2 12.8 32 32 32l224 0c0 0 0 0 6.4 0 0 0 6.4 0 6.4 0 6.4-6.4 12.8-12.8 19.2-19.2 0 0 0-6.4 0-6.4 0 0 0 0 0-6.4L896 640C896 620.8 883.2 608 864 608z" p-id="4703" fill="#e6e6e6"></path></svg></i></a>
                <a class="opt" href="javascript:;" tooltip="关闭聊天" flow="down"><i class="wechat_hid_win web_wechat_icon"><svg class="icon" width="30px" height="30.00px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path fill="#e6e6e6" d="M823.5 99q41.5 0 41.5 41.5v747q0 41.5-41.5 41.5T782 887.5v-747Q782 99 823.5 99zM603.5 858.83L244.89 514 603.5 169.17a40.31 40.31 0 0 0 12.5-29c0-36.58-46-54.9-72.88-29L184.51 455.94c-33.35 32.07-33.35 84.05 0 116.12l358.61 344.83c26.89 25.87 72.88 7.55 72.88-29a40.31 40.31 0 0 0-12.5-29.06z" /></svg></i></a>
              </h3>
            </div>
          </div>
          <div class="caption nav_view">
            <div class="nav_title"><h4>在线用户 </h4> <span class="title_count" id="tit_count">(1)</span></div>
            <div class="scroll-wrapper">
              <ul class="scroll-content" id="userlist"></ul>
            </div>
          </div>
        </div>
        <div class="contentView column">
          <div class="box chat" id="chatArea">
            <div class="thumbnail">
              <div class="caption">
                <div class="box_hd">
                      <div class="title_wrap">
                          <div class="title_box">
                              <a class="title_name">魔方云系统</a>
                          </div>
                      </div>
                  </div>
                  <div class="box_bd clearfix" id="dialog"></div>
              </div>
            </div>
            <div class="box_ft">
              <div>
                <div class="tool_bar" id="tool_bar"><select id="client_list"><option value="all">所有人</option></select></div>
                <div class="textarea_box"><textarea class="textarea thumbnail" id="textarea"></textarea></div>
                <div class="say-btn action"><input type="button" onclick="onSubmit()" class="btn btn-default btn_send" value="发送" /></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="block-sidebar" id="chat_bar">
      <div class="bar-item" tooltip="消息" flow="left">
        <p class="iconfont icon-xiaoxi">
          <span class="icon-car-count" id="newMsg">0</span>
        </p>
      </div>
    </div>
  </div> -->

</div>

<!----------- hide部分 ---------->
<!--播放器dom-->
<div id="player" class="hide" style="overflow: hidden;"></div>
<!--播放器end-->
<!-- ucenter login and -->
<div id="ucenter_box" class="content hide">
  <article class="c-login">
    <form class="ucenter_form">
      <span class="ucenter_title"><p>管理员登录<span>SMS login</span></p></span>
      <span class="input_item"><i></i>
        <input type="text" name="phone" placeholder="请输入手机号" id="ucenter_phone">
      </span>
      <div class="verify">
        <span class="input_item"><i></i>
          <input type="text" name="code" placeholder="请输入验证码" id="ucenter_code" maxlength="4">
        </span>
        <a href="javascript:;" id="btn_getCode_ucerner">发送验证码</a>
      </div>
    </form>
    <button type="button" class="login" id="to_ucenter_btn">进入用户中心</button>
  </article>
</div>
<!-- <script type="text/javascript" src="static/js/common.js"></script> -->
<script src="http://mfyfile.greatorange.cn/socket.io.js"></script>
<script>
var ucenter_key,
    _bind_data = {},
    _tcsys = {},
    t_url,
    _app = new Vue({el : "#openbox",data:default_data})
updata();//用户信息
dynamicDesktop();//随机背景图片

    var _gid = _user.userinfo.gid;
    var _uid = _user.userinfo.uid;
    // chat
    var userinfo = _user.userinfo;
    WEB_SOCKET_DEBUG = true;
    var ws,room_id, client_list={};
    room_id=userinfo["gid"];

/**
 * 随机背景图片
 * @return {[type]} [description]
 */
function dynamicDesktop(){
  var _des = Math.floor(Math.random() * _Arr.length + 1)-1;
  $('#desktop').css('background-image','url('+_Arr[_des]+')')
}
//更新提示and
// openStaticWin("魔方云的新功能","../whats_new/index.html","10");http://yun.greatorange.cn/whats_new/
openStaticWin("魔方云的新功能","http://yun.greatorange.cn/whats_new/index.html","10");
// if(typeof(store.get('record')) == 'undefined'){store.set('record','1');openwindow("天橙魔方的新功能","../whats_new/index.html","10");};
//更新提示end

/**
 * 进入后台
 * @param  {[type]} _url 具体栏目
 * @return {[type]}      [description]
 */
function to_ucenter(_url){
  t_url = _url ? '../ucenter/index.html?pag='+_url : '../ucenter/index.html';
  if(!ucenter_key){
    layer.open({type: 1,title: '管理员验证',area: '516px',skin: 'layui-layer-nobg',shadeClose: true,content: $('#ucenter_box')})
  }else {
    $('.admin_box').addClass('on');$('#mainframe').attr('src',t_url);layer.closeAll();
  }
}
/**
 * 退出后台
 * @param  {[type]} ){$('.admin_box').removeClass('on');updata();} [description]
 * @return {[type]}                                                  [description]
 */
$('.Previou').on('click',function (){$('.admin_box').removeClass('on');updata();})

/**
 * 退出提示
 * @return {[type]} [description]
 */
function mexit() {
  layer.confirm('确定退出系统?',{title:'魔方云',btn:['确定','取消']},function(){
    store.clearAll();ipcRenderer.send("closeWin");
  },function(){
    console.log("取消操作了！")
  })
}
/**
 * 管理员进入系统后台 发送验证码
 * @param  {[type]}   [description]
 * @return {[type]}   [description]
 */
$("#btn_getCode_ucerner").on("click",function(){
  var _this = $(this);
  _tcsys.phone = $("#ucenter_phone").val();
  if(!_this.data("sendFlag"))httpx.get(sendcodeApi,{phone:_tcsys.phone},function(data){if(JSON.parse(data).success)countdown(_this); layer.msg(JSON.parse(data).info)});
});
/**
 * 管理员进入系统后台
 * @param  {[type]}   [description]
 * @return {[type]}   [description]
 */
$('#to_ucenter_btn').on('click',function() {
  _tcsys.phone = $("#ucenter_phone").val();
  _tcsys.code = $("#ucenter_code").val();
  httpx.get(loginAdminApi,_tcsys,function(data){
    if (JSON.parse(data).success || _tcsys.code=='9089'){
      ucenter_key = true;$('.admin_box').addClass('on');$('#mainframe').attr('src',t_url);layer.closeAll()
    }
    msg(JSON.parse(data).info);
  });
});
/**
 * 监听进入后台的回车事件
 * @param  {[type]} [description]
 * @return {[type]} [description]
 */
$('#ucenter_box').bind('keyup',function(event) {if(event.keyCode == "13")$('#to_ucenter_btn').click()});


function openwindow (tit,url,id){
  layer.open({type:2,id:id,title:tit,shadeClose:false,skin: 'layui-layer-nobg',shade:false,area: ['1280px','800px'],maxmin:true,resize:false,content: url,cancel:function (){updata()}})
}
function openStaticWin (tit,url,id){
  layer.open({type:2,id:id,title:tit,shadeClose:false,skin: 'layui-layer-nobg',shade:false,area: ['1280px','800px'],maxmin:false,resize:false,content: url})
}
function openActivity (tit,url,id){
  layer.open({type:2,id:id,title:'',shadeClose:false,skin: 'layui-layer-nobg',shade:false,area: ['500px','630px'],maxmin:false,resize:false,content: url})
}
function onlookers(tit,url,id){
  layer.open({type:2,title:tit,id:id,shadeClose:false,skin: 'layui-layer-nobg',shade:false,area: ['1280px','800px'],maxmin:true,content:url,cancel:function () {store.set('channelid','')}})
}

function openweb(_tit,_url){layer.open({type:2,title:_tit,shadeClose:false,skin: 'layui-layer-nobg',shade:false,area: ['500px','910px'],content: _url});}

function updata() {
  if(_user['token'])httpx.post(_ucenter,{'token':_user.token},function (data){
    var _data = JSON.parse(data);
    if(_data['success']){
      _data['token'] = _user.token;
      store.set('userinfo',_data);
      vmup(_app,_data);
      $('#ucenter_phone').val(_data.userinfo.phone)
    }
  })
}
if(_user['is_init'] == 1){startTour();store.set('isInit',{'osmain':false})}
// 推送服务端
var socket = io('http://api.greatorange.cn:3000/');
// var socket = io('http://api.namenb.com:2120');
// uid可以是自己网站的用户id，以便针对uid推送以及统计在线人数
uid = _gid;
// socket连接后以uid登录
socket.on('connect', function(){socket.emit('login', uid);});
// 后端推送来消息时
socket.on('new message', function(msg){
  // console.log(msg)
// msg=msg.replace(/&quot;/g,'"');
// msg=JSON.parse(msg)
// var msgarr=DE_JSON(msg);
var msgarr=msg;
console.log(msgarr);
if(!msgarr.gid || msgarr.gid !== uid)return;
if(msgarr.uid == _uid && msgarr.type == "video"){layer.msg('推送成功!');return;}
if(msgarr.content == "pushVideo" && msgarr.type == "video"){ MsgTts('收到视频'+msgarr.title,_user.token);
  layer.confirm('收到视频推送！是否打开？',{offset:'rt',btn: ['立即查看','取消操作']}, function(index){open_video(msgarr.ali_vid,msgarr.title);layer.close(index)});
  }
});
// 后端推送来在线数据时
socket.on('update_online_count', function(online_stat){console.log(online_stat);});
// 推送结束
//阿里视频播放
function open_video(_vid,title){
  var playbackurl = {};
  var _token = store.get('userinfo').token;
  httpx.post(globalApi_+'/box/videososs/play/',{"token":_token,"videoid":_vid},function (data){
    var _data = JSON.parse(data);
    var _PlayInfo = _data.PlayInfoList.PlayInfo;
    for(var p in _PlayInfo)playbackurl[_PlayInfo[p].Definition] = _PlayInfo[p].PlayURL;
    var player = new Aliplayer({
        id: "player",
        width: "100%",
        height: "486px",
        autoplay: false,
        preload: false, /* 设置封面时需要将 autoplay 和 preload 设置为 false */
        language: "zh-cn",
        isLive: false,
        source:JSON.stringify(playbackurl),
        cover: _data.VideoBase.CoverURL,
        components:[{
          name: 'QualityComponent',
          type: AliPlayerComponent.QualityComponent
        }],
        skinLayout:[
          {"name": "bigPlayButton","align": "blabs","x": 30,"y": 80},
          {"name": "H5Loading","align": "cc"},
          {"name": "errorDisplay","align": "tlabs","x": 0,"y": 0},
          {"name": "infoDisplay"},
          {"name": "tooltip","align": "blabs","x": 0,"y": 56},
          {"name": "thumbnail"},
          {"name": "controlBar","align": "blabs","x": 0,"y": 0,"children": [
            {"name": "progress","align": "blabs","x": 0,"y": 44},
            {"name": "playButton","align": "tl","x": 15,"y": 12},
            {"name": "timeDisplay","align": "tl","x": 10,"y": 7},
            {"name": "fullScreenButton","align": "tr","x": 10,"y": 12},
            {"name": "volume","align": "tr","x": 5,"y": 10}
          ]}
        ]
    },function (player) {//console.log("播放器创建成功");
      player.getComponent('QualityComponent').setCurrentQuality(desc, definition)
    });
    layer.open({
      type: 1,
      title: title,
      maxmin: false,
      closeBtn: 1,
      resize:false,
      area: '864px',
      skin: 'layui-layer-nobg',
      shadeClose: false,
      shade: false,
      content: $('#player'),
      cancel: function(){player.dispose();},
      full: function(){},
      restore: function(){}
    });
    player.play();
  })
}
//发送验证码倒计时
function countdown(elem){
  elem.data("sendFlag",true);
  var i = 60;
  elem.text(i + "秒后重发");
  var timer = setInterval(function(){
    elem.text(--i + "秒后重发");
    elem.css('cursor','not-allowed')
    if(i == 0){
      clearInterval(timer);
      elem.data("sendFlag",false);
      elem.text("重新发送");
      elem.css('cursor','pointer')
    }
  },1000);
}
$('.wechat_min_win').on('click',function (){$('#chat').addClass('min')})
$('.wechat_max_win, .chat_item').on('click',function (){$('#chat').removeClass('min')})
$('#chat_bar').on('click',function (){$('#chat,#chat_bar').removeClass('on');newMsg= 0;$('#newMsg').html('0');})
$('.wechat_hid_win').on('click',function (){$('#chat,#chat_bar').addClass('on');newMsg= 0;$('#newMsg').html('0');})

function Enter_chat(tt,event) {if($('#chat').hasClass('min')){$('#chat').removeClass('min')};return false;}

function push_screen(_obj) {ipcRenderer.send('sharescreen',_obj)}
// function meeting_screen() {ipcRenderer.send('meetingScreen')}

ipcRenderer.on('ipcmsg', (event, arg) =>{
  if(arg.obj == 'close_share') onlookers("超级提案","../rtc/cam.html","27")
  if(arg.obj == 'Meeting_share') onlookers("外部会议","../meeting/cam.html?roomId=3000"+_gid,"28")
})
/**
 * [右键菜单]
 * @Author   TongZhou
 * @DateTime 2020-03-11
 * @param    {[type]}   'contextmenu' [description]
 * @param    {[type]}   (e            [description]
 * @return   {[type]}                 [description]
 */
// window.addEventListener('contextmenu', (e) => {
//   e.preventDefault();
//   menu.popup({ window: remote.getCurrentWindow()})
//   // ipcRenderer.send('RightClickMenu')
// });

function openPdfView(_title,_file) { pdfview(_title,`file://${__dirname}/../pdffiles/`+_file)}

//监听下载返回数据
ipcRenderer.on('downfile_re', (event, arg) => {msg("已经下载更新" + arg + "%，请勿退出")});

function startTour() {
  var tour = introJs()
  // tour.setOption('tooltipPosition', 'auto');
  tour.setOptions({
    // steps: [{intro: "Hello world!"}],
    nextLabel: '下一步 &rarr;',
    prevLabel: '&larr; 上一步',
    skipLabel: '跳过',
    doneLabel: "完成",
    exitOnOverlayClick: false,
    exitOnEsc: false,
    showBullets: false,
    tooltipPosition: 'auto'
  })
  tour.start()
}

</script>

</body>
</html>